<!DOCTYPE html>
<head>
  <title>Issue updates</title>
  <style>
  body {
    font-family: sans-serif;
  }
  ul {
    padding-left: 1em;
  }
  ul.issue {
    padding-left: 0em;
    list-style-type: none;
    margin-bottom: 1em;
  }
  ul.issue > li {
    margin: .5em 0;
  }
  ul.issue p {
    margin: 0 0 0 2em;
  }
  ul.comment {
    padding-left: 3em;
  }
  .icon {
    display: inline-block;
    width: .75em;
  }
  </style>
<body>
<h1>Issue updates since {{ since|datetime("%Y-%m-%d") }}</h1>
<ul class="repo">
  {% for kind, thing, issues in results -%}
    <li>{{ kind }} {{thing}}
      <ul class="issue">
        {% for issue in issues -%}
          <li class="{{ issue.state|lower }}">
            <span class="icon created">{% if issue.reasonCreated %}&Star;{% else %}&ndash;{% endif %}</span>
            <span class="icon closed">{% if issue.reasonClosed %}&times;{% else %}&ndash;{% endif %}</span>
            <a href="{{ issue.url }}">{{ issue.number }}: {{issue.title}}</a>
            [{{ issue.author.login }}]
            {% if kind == "project" %}{{ issue.repository.nameWithOwner }}{% endif %}
            <p>{{ issue.body|truncate(120) }}</p>
            <ul class="comment">
              {% for comment in issue.comments.nodes -%}
                <li>
                  {# <img src="{{comment.author.avatarUrl}}&size=20"/> #}
                  <a href="{{ comment.url }}">{{ comment.updatedAt|datetime() }}</a>
                  [{{ comment.author.login }}]
                  {{ comment.body|trim|truncate(120) }}
                </li>
              {% endfor %}
            </ul>
          </li>
        {% endfor %}
      </ul>
    </li>
  {% endfor %}
</ul>
